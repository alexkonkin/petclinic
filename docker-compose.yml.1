version: '3'

services:
   ngnx:
     image: nginx:latest
     ports:
       - 10.0.2.15:80:80
     depends_on:
       - app

   app:
     image: petclinic:latest
     depends_on:
       - db 

   db:
     image: mysql:latest 
     ports:
       - 10.0.2.15:3306:3306 # change ip if required
     command: [
        '--default_authentication_plugin=mysql_native_password',
        '--character-set-server=utf8mb4',
        '--collation-server=utf8mb4_unicode_ci'
     ]
     volumes:
      - ./petclinic-data:/docker-entrypoint-initdb.d
      - ./db_data:/var/lib/mysql
     environment:
       MYSQL_DATABASE: "petclinic"
       MYSQL_ROOT_PASSWORD: "123456"
